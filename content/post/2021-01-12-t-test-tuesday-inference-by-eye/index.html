---
title: 'T-Test Tuesday: Inference by Eye'
author: Nathan Brouwer
date: '2021-01-11'
slug: t-test-tuesday-inference-by-eye
categories:
  - statistics
tags:
  - basic R
  - learnr
  - t-test tuesday
  - t.test
  - statistics
math: no
meta: yes
toc: yes
---


<div id="TOC">
yes
</div>

<!--more-->
<p>A an example of doing “inference by eye” using R.A. Fisher’s cat data. A good summary of this idea is Cummings et al. 2007. Error bars in experimental biology. <a href="http://jcb.rupress.org/content/177/1/7.short" class="uri">http://jcb.rupress.org/content/177/1/7.short</a></p>
<div id="load-the-data" class="section level2">
<h2>Load the data</h2>
<pre class="r"><code>library(MASS)
data(cats)</code></pre>
</div>
<div id="look-at-the-data" class="section level2">
<h2>Look at the data</h2>
<pre class="r"><code>dim(cats)
summary(cats)</code></pre>
</div>
<div id="summarize-the-body-weight-bwt-data-old-school-using-summaryby" class="section level2">
<h2>Summarize the body weight (Bwt) data old-school using summaryBy()</h2>
<p>A more modern way would be to use dplyr()</p>
<pre class="r"><code>library(doBy)

#get the mean and SD
cat.df1 &lt;- summaryBy(Bwt ~ Sex, data = cats, FUN = c(mean,sd))

#get the sample size using length()
cat.df2 &lt;- summaryBy(Bwt ~ Sex, data = cats, FUN = c(length))

#make a combined dataframe
cat.df3 &lt;- merge(cat.df1,cat.df2)

#calculate the standard error SE by hand

cat.df3$SE &lt;- cat.df3$Bwt.sd/sqrt(cat.df3$Bwt.length)</code></pre>
<p>Look at the results</p>
<pre class="r"><code>cat.df3</code></pre>
</div>
<div id="plot-the-data" class="section level2">
<h2>Plot the data</h2>
<div id="visualize-the-raw-data" class="section level3">
<h3>Visualize the raw data</h3>
<pre class="r"><code>par(mfrow = c(1,1),mar = c(3,3.5,1,1))

boxplot(Bwt ~ Sex, data = cats)</code></pre>
</div>
<div id="plot-the-means-with-error-bars" class="section level3">
<h3>Plot the means with error bars</h3>
<p>This uses the errbar() function. A modern contemporary way would use ggplot2 and possibly its extension using ggpubr.</p>
<div id="the-real-data" class="section level4">
<h4>The real data</h4>
<p>This is the actual data. The 95% confidence intervals do not overlap, which indicates that the p-value for the t-test will be less than 0.05.</p>
<pre class="r"><code>library(Hmisc)
par(mfrow = c(1,2),mar = c(3,3.5,1,1))

y.lim &lt;- c(2.295,3)
errbar(1:2,
       y = cat.df3$Bwt.mean,
       yplus =cat.df3$Bwt.mean + cat.df3$SE,
       yminus = cat.df3$Bwt.mean-cat.df3$SE,
       xlab = &quot;&quot;,
       ylab = &quot;&quot;,
       xlim=c(0.5,2.5),
       ylim = y.lim,
       xaxt=&quot;n&quot;,cex =1)
axis(side=1,at=1:2,labels=cat.df3$Sex)
mtext(&quot;Sex&quot;, side = 1, line = 2, cex = 2)
mtext(&quot;Mass (g)&quot;, side = 2, line = 2.1, cex = 1.3)

errbar(1:2,
       y = cat.df3$Bwt.mean,
       yplus =cat.df3$Bwt.mean + 1.96*cat.df3$SE,
       yminus = cat.df3$Bwt.mean-1.96*cat.df3$SE,
       xlab = &quot;&quot;,
       ylab = &quot;&quot;,
       xlim=c(0.5,2.5),
       ylim = y.lim,
       xaxt=&quot;n&quot;,cex =1)
axis(side=1,at=1:2,labels=cat.df3$Sex)
mtext(&quot;Sex&quot;, side = 1, line = 2, cex = 2)
mtext(&quot;Mass (g)&quot;, side = 2, line = 2.1, cex = 1.3)</code></pre>
</div>
<div id="modified-data-with-a-non-significant-different" class="section level4">
<h4>Modified data with a non-significant different</h4>
<p>Make an alternative version of the data where there isn’t a difference between the male and female cats</p>
<pre class="r"><code>cat.df3.mod &lt;- cat.df3
cat.df3.mod$Bwt.mean[1] &lt;- cat.df3$Bwt.mean[2]-cat.df3$Bwt.mean[2]*0.0425</code></pre>
<p>The overlap of the error bars here is greater than 1/2 the length of the bar; therefore the p-value for a t-test will be &gt; 0.05.</p>
<pre class="r"><code>y.lim &lt;- c(2.6975,3)
par(mar = c(3,3.5,1,1))
errbar(1:2,
       y = cat.df3.mod$Bwt.mean,
       yplus =cat.df3.mod$Bwt.mean + cat.df3.mod$SE,
       yminus = cat.df3.mod$Bwt.mean-cat.df3.mod$SE,
       xlab = &quot;&quot;,
       ylab = &quot;&quot;,
       xlim=c(0.5,2.5),
       ylim = y.lim,
       xaxt=&quot;n&quot;,cex =1)
axis(side=1,at=1:2,labels=cat.df3.mod$Sex)
mtext(&quot;Sex&quot;, side = 1, line = 2, cex = 2)
mtext(&quot;Mass (g)&quot;, side = 2, line = 2.1, cex = 1.3)

errbar(1:2,
       y = cat.df3.mod$Bwt.mean,
       yplus =cat.df3.mod$Bwt.mean + 1.96*cat.df3.mod$SE,
       yminus = cat.df3.mod$Bwt.mean-1.96*cat.df3.mod$SE,
       xlab = &quot;&quot;,
       ylab = &quot;&quot;,
       xlim=c(0.5,2.5),
       ylim = y.lim,
       xaxt=&quot;n&quot;,cex =1)
axis(side=1,at=1:2,labels=cat.df3.mod$Sex)
mtext(&quot;Sex&quot;, side = 1, line = 2, cex = 2)
mtext(&quot;Mass (g)&quot;, side = 2, line = 2.1, cex = 1.3)</code></pre>
</div>
</div>
</div>
<div id="t-test" class="section level2">
<h2>T-test</h2>
<p>A t-test for the differenec between female and male cats.</p>
<pre class="r"><code>t.test(Bwt ~ Sex, data = cats)</code></pre>
<pre class="r"><code>summary(lm(Bwt ~ -1+Sex, data = cats))</code></pre>
</div>
